{% include '/reports/tab_bar.html' %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
<script src="https://kit.fontawesome.com/f74abea1e2.js" crossorigin="anonymous"></script>

<style>
    :root {
        --color-blue-light: rgba(33, 150, 243, 0.1);
        --color-green-light: rgba(76, 175, 80, 0.1);
        --color-purple-light: rgba(156, 39, 176, 0.1);
        --color-orange-light: rgba(255, 152, 0, 0.1);
        --color-pink-light: rgba(233, 30, 99, 0.1);
        --color-teal-light: rgba(0, 150, 136, 0.1);
        --color-yellow-light: rgba(255, 235, 59, 0.1);
        --color-indigo-light: rgba(63, 81, 181, 0.1);
        --primary-color: #1998bf;
    }


    body {
        font-family: Arial, sans-serif;
        background: #f5f5f5;
        color: #333;
        background-color: #e8f4fc; /* Light blue background */

    }

    .dashboard-container {
        max-width: 1400px;
        margin: 0 auto;
        background-color: #e8f4fc; /* Light blue background */
    }

    .section {
        /* background: white; */
        padding: 15px;
        margin-bottom: 20px;
        /* border-radius: 12px; */
        /* box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); */
    }

    /* .section-title {
        margin-bottom: 20px;
        color: #333;
        padding-bottom: 10px;
        border-bottom: 2px solid #eee;
    } */

    /* .social-card {
        background: var(--color-purple-light);
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 15px;
    } */

    .review-card {
        background: var(--color-green-light);
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 15px;
    }

    .funnel-stage {
        margin: 0 auto;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        margin-bottom: 10px;
    }

    .stats-container {
        background: var(--color-teal-light);
        padding: 20px;
        border-radius: 12px;
        margin-top: 20px;
    }

    .social-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
    }

    .social-card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .social-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
    }

    .social-logo {
        width: 30px;
        height: 30px;
        margin-right: 10px;
    }

    .social-title {
        font-size: 1.2em;
        font-weight: bold;
        color: #333;
        margin-left:5px;
    }

    .social-stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }

    .stat-item {
        padding: 8px;
        background: #f8f9fa;
        border-radius: 4px;
        text-align: center;
    }

    .stat-value {
        font-size: 1.2em;
        font-weight: bold;
        color: #2c3e50;
    }

    .stat-label {
        font-size: 0.9em;
        color: #666;
        margin-top: 4px;
    }

    .google-reviews {
        padding: 20px;
        border-radius: 8px;
    }

    .google-reviews h3 {
        font-size: 2rem;
        margin-bottom: 20px;
        text-align: center;
        font-weight: bold;
    }

    /* Ratings summary section */
    .ratings-summary {
        display: flex;
        justify-content: space-between;
        gap: 20px;
        margin-bottom: 20px;
    }

    .rating p {
        font-size: 1.5rem;
        font-weight: bold;
    }

    .reviews-count p {
        font-size: 1.2rem;
    }

    .reviews-boxes {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
    }

    .review {
        background: #fff;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .reviewer {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 10px;
    }

    .reviewer img {
        height: 40px;
        width: 40px;
        border-radius: 50%;
    }

    /* Charts Grid Styling */
    .charts-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-top: 20px;
        justify-items: center;
        align-items: center;
    }

    .chart-container {
        background-color: #fff;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        width: 250px;
        height: 250px;
    }


    /* Channels Box Styling */
    .channels-box {
        padding: 20px;
        background-color: #f8f8f8;
        border-radius: 10px;
        text-align: center;
    }

    .channel-card {
        display: flex;
        align-items: center;
        padding: 10px;
        margin: 5px 0;
        color: #333;
        font-size: 1rem;
        font-weight: bold;
        text-align: left;
    }

    .channel-card .channel-color {
        width: 15px;
        height: 15px;
        border-radius: 50%;
        margin-right: 10px;
    }

    /* Social icons styling */
    .channel-icon {
        font-size: 30px;
    }

    .facebook-icon {
        color: #3b5998;
    }

    .youtube-icon {
        color: #ff0000;
    }

    .instagram-icon {
        color: #e4405f;
    }

    .email-icon {
        color: #0072c6;
    }

    .sms-icon {
        color: #25d366;
    }

    .whatsapp-icon {
        color: #25d366;
    }

    /* Grid layout for key metrics cards with two rows */
    .metrics-grid {
        display: flex;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;

    }

    /* Metric Cards */
    .metric-card {
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .metric-card2 {
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        height:110px;
        background: white;
    }

    .metric-icon {
        font-size: 2rem;
        margin-bottom: 10px;
    }

    .metric-value {
        font-size: 1.5rem;
        font-weight: bold;
        display: flex;
        align-items: center;
    }

    .metric-value2 {
        font-size: 20px;
        font-weight: bold;
    }

    .up-arrow {
    color: #10e410;
    margin-left: 5px;
    font-size:1.1rem;
}

    .metric-label {
        font-size: 1rem;
        margin-top: 5px;
    }

    /* Spend & New Subscribers Grid */
    .spend-subscribers-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }

    /* Spend Cards */
    .spend-card {
        background-color: #f8f8f8;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    }

    .spend-icon {
        font-size: 2rem;
        margin-bottom: 10px;
    }

    .spend-value {
        font-size: 20px;
        font-weight: bold;
    }

    .spend-label {
        font-size: 1rem;
        margin-top: 5px;
    }

    /* Charts Grid for Doughnut Chart and Other Chart */
    .chart-container {
        height: 250px;
    }

    .active-channels {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 15px;
        margin-top: 20px;
    }

    /* Active Channel Icons */
    .channel-icon-container {
        font-size: 2.5rem;
        display: inline-block;
    }


    /* Media Query for Smaller Screens */
    @media (max-width: 768px) {

        .metrics-grid,
        .spend-subscribers-grid,
        .charts-grid {
            grid-template-columns: 1fr;
        }

        .channel-icon-container {
            font-size: 2rem;
        }

        /* Smaller charts on mobile */
        .chart-container {
            height: 200px;
        }
    }

    .chart-container-spread {
        background: white;
        padding: 10px;
        border-radius: 8px;
        height: 290px;
        width: 300px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
    }

    .chart-container-bar {
        background: white;
        padding: 10px;
        border-radius: 8px;
        height: 210px;
        width: 350px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .chart-container-channel {
        background: white;
        padding: 10px;
        border-radius: 8px;
        height: 210px;
        width: 250px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
    }

    .channels-list {
    font-size: 15px;
    font-weight: 600;
    display: flex;
    flex-direction: column;
    gap: 10px;
}


    .chart-container-social {
        background: white;
        padding: 10px;
        border-radius: 8px;
        height: 210px;
        width: 300px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        margin-left:10px;
    }

    .social-btn {
        display: flex;
        justify-content: space-around;
    }

    .post-calendar-grid3 {
            display: flex;
            gap: 20px;
            text-align: center;
        }

        .post-calendar-card3 {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid rgb(104, 91, 91);
            flex: 1;
        }

        .post-calendar-card3 h3 {
            font-size: 1rem;
            color: #333;
            margin-bottom: 10px;
        }

        .post-adjust3 {
            display: flex;
            justify-content: space-around;
        }

        .stats-cards-wrapper3 {
        display: flex;
        gap: 5px;
        flex-wrap: wrap;
        margin-bottom: 15px;
    }
    .side-card-post3 {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            flex: 1;
            max-height: 350px;
        }

        .stats-title3 {
            color: #1e293b;
            font-size: 13px;
            font-weight: 600;
            padding: 8px;
            border-bottom: 1px solid #e5e7eb;
            text-align: center;
        }

        .stats-content3 {
            padding: 3px 0px 5px;
            text-align: center;
            display: flex;
            flex-direction: column;
        }

        .stats-number3 {
            font-size: 13px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .stats-label3 {
            color: #94a3b8;
            font-size: 13px;
            font-weight: 500;
        }

        .container3 {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
            padding:20px;
        }

        .metrics-container3 {
            display: flex;
            flex-direction: column;
            margin-right: 20px;
        }

        .stats-card3 {
            background: white;
            border-radius: 15px;
            width: 130px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
        }

        .post-adjust3 {
            display: flex;
            justify-content: space-around;
        }

        h2 {
            color: #1e293b;
            font-size: 22px;
            margin-bottom: 24px;
            font-weight: 500;
        }
    /* leads section */
    .stats-cards-wrapper {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
        margin-bottom: 24px;
    }

    .stats-card {
        background: white;
        border-radius: 25px;
        width: 240px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
    }

    .stats-card1 {
        background: white;
        border-radius: 25px;
        width: 200px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
    }

    .stats-title {
        color: #1e293b;
        font-size: 14px;
        font-weight: 600;
        padding: 10px;
        border-bottom: 1px solid #e5e7eb;
        text-align: center;
    }

    .stats-content {
        padding: 3px 0px 5px;
        text-align: center;
    }

    .stats-number {
        font-size: 18px;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 5px;
    }

    .stats-label {
        color: #94a3b8;
        font-size: 16px;
        font-weight: 500;
    }


    /* Chart Section */
    .charts-section {
        display: flex;
        gap: 24px;
    }

    .chart-container {
        background: white;
        border-radius: 25px;
        padding: 24px;
        flex: 0 0 40%;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        text-align: center;
        height:350px;
    }

    #socialChart {
        height: 250px;
        max-height: 240px;
        width: 100%;
    }


    .google-section {
        border-radius: 25px;
        padding: 32px;
    }

    .google-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 40px;
    }

    .google-left {
        flex: 1;
    }

    .google-right {
        flex: 1;
        display: flex;
        gap: 20px;
        justify-content: center;
    }

    .google-logo {
        width: 250px;
        margin-bottom: 16px;
    }

    .verified-text {
        font-size: 28px;
        color: #1e293b;
        margin-bottom: 16px;
    }

    .rating-card {
        background: white;
        border-radius: 15px;
        padding: 20px 32px;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .rating-number {
        font-size: 18px;
        font-weight: bold;
        color: #1e293b;
        margin-bottom: 8px;
    }

    .rating-label {
        color: #64748b;
        font-size: 14px;
    }

    .stars {
        color: #FFC107;
        font-size: 32px;
    }

    .verified-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        background-color: #34A853;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        margin-right: 8px;
        font-size: 16px;
    }


    .container {
        padding: 20px;
    }

    .dropdown-container {
        display: flex;
        justify-content: flex-start;
        margin-bottom: 20px;
        width:150px;
    }

    /* paid analytics */
    .metrics-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-right: 20px;
    }

    .metrics-row {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }

    .metric-card {
        background-color: #fff;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        flex: 1;
        text-align: center;
        max-width: 240px;
    }

    .side-card {
        background-color: #fff;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        flex: 1;
    }

    .metric-title {
        font-size: 14px;
        color: #666;
        margin-bottom: 10px;
        border-bottom: 1px solid #e5e7eb;
        font-weight: bold;
    }

    .metric-value {
        font-size: 18px;
        color: #333;
    }

    .trend-up {
        color: #4caf50;
    }

    .channels-list {
        list-style: none;
        padding: 0;
    }

    .channel-dot {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 8px;
    }

    .donut-container {
        position: relative;
        width: 100%;
        height: 200px;
    }

    .chart-center-value {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 16px;
        font-weight: bold;
    }

    .trend-up {
        color: #4caf50;
    }

    .channels-card {
        flex: 1;
        max-width: 300px;
    }

    @media (max-width: 768px) {
        .stats-cards-wrapper {
            flex-direction: column;
        }

        .charts-section {
            flex-direction: column;
        }

        .google-content {
            flex-direction: column;
        }

        .google-right {
            width: 100%;
        }
    }

    /* Container styles */
.month-selector-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 20px;
    border-radius: 8px;
}

.choose-label {
    font-size: 14px;
    font-weight: 500;
    color: #4a4a4a;
    margin-right: 10px;
}

.month-selector {
    display: flex;
    gap: 5px;
    margin-right:380px;
}

.arrow-btn {
    background-color: #ffffff;
    border: 1px solid #dcdcdc;
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
    color: #4a4a4a;
}

.arrow-btn:hover {
    background-color: #f2f2f2;
}

.month-dropdown,
.year-dropdown {
    background-color: #ffffff;
    border: 1px solid #dcdcdc;
    border-radius: 5px;
    padding: 5px 10px;
    font-size: 14px;
    color: #4a4a4a;
    cursor: pointer;
}

.action-buttons {
    display: flex;
    align-items: center;
    gap: 10px;
}

.reportSection,
.download-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #ffffff;
    border: 1px solid #dcdcdc;
    border-radius: 5px;
    padding: 5px 15px;
    font-size: 14px;
    cursor: pointer;
    color: #4a4a4a;
    transition: all 0.3s ease-in-out;
}

.download-btn {
    background-color: #007bff;
    color: #ffffff;
}

.reportSection i,
.download-btn i {
    margin-right: 5px;
}

.reportSection:hover {
    background-color: #f2f2f2;
}

.download-btn:hover {
    background-color: #0056b3;
}


</style>
<div id="reportSection">
    <div class="dashboard-container">
    {% if user_organization.id %}
    <header>
        <div class="month-selector-container">
            <label for="month" class="choose-label">Choose month:</label>
            <div class="month-selector">
                <button class="arrow-btn left-arrow">←</button>
                <select id="month" class="month-dropdown">
                    <option>January</option>
                    <option>February</option>
                    <option selected>March</option>
                    <option>April</option>
                    <option>May</option>
                    <option>June</option>
                    <option>July</option>
                    <option>August</option>
                    <option>September</option>
                    <option>October</option>
                    <option>November</option>
                    <option>December</option>
                </select>
                <select id="year" class="year-dropdown">
                    <option>2020</option>
                    <option selected>2021</option>
                    <option>2022</option>
                    <option>2023</option>
                </select>
                <button class="arrow-btn right-arrow">→</button>
            </div>
            <div class="action-buttons">
                <a class="link-in-iframe1">
                    <i class="fas fa-print"></i> Print
                </a>
            
                <a class="download download-btn">
                    <i class="fas fa-download"></i> Download
                </a>
            </div>
        </div> 
        <b><hr style="margin-bottom: 20px;
        margin-top:0px;
            padding: 0;
            position: relative;
            border-bottom: 2px solid var(--primary-color);"></b>
    </header>


    <section class="section">
        <!-- Grid Layout for Key Metrics -->
        <div class="d-flex mb-3">
            <div>
                <div class="metrics-grid mr-2">
                    <!-- First Row of Metrics -->
                    <div class="metric-card2 reach d-flex">
                        <div class="mr-5">
                            <div class="metric-label">Reach</div>
                            <div class="metric-value">{{ reports.data.reach }}<i class="fa fa-arrow-up up-arrow"></i></div>
                        </div>
                        <div class="pl-5 ml-3">
                            <div class="metric-label">Engagement</div>
                            <div class="metric-value">{{ reports.data.engagement }}<i class="fa fa-arrow-up up-arrow"></i></div>
                        </div>
                    </div>

                    <div class="metric-card2 d-flex" >
                        <img style="width:50px;height:50px; margin-top:20px;"src="https://www.pngitem.com/pimgs/m/55-557586_gold-dollar-sign-png-gold-dollar-sign-clipart.png">
                        <div class="mr-2">
                            <div class="spend-label">WhatsApp Spend</div>
                            <div class="spend-value">{{ reports.data.whatsAppSpend }}</div>
                        </div>
                        <div class="pl-5">
                            <div class="spend-label">Facebook Spend</div>
                            <div class="spend-value">{{ reports.data.facebookSpend }}</div>
                        </div>
                    </div>
                </div>
                <div class="d-flex">
                    <!-- Second Row of Metrics -->
                    <div class="metric-card2 mr-3" >
                        <div class="metric-label">Total Subscribers</div>
                        <div class="metric-value2">{{ reports.data.totalSubscribers }}</div>
                    </div>
                    <div class="metric-card2 mr-3" >
                        <div class="metric-label">Subscription Growth Rate</div>
                        <div class="metric-value2">{{ reports.data.subscriptionGrowthRate }}</div>
                    </div>
                    <div class="metric-card2">
                        <div class="metric-label">New Subscribers</div>
                        <div class="metric-value2">{{ reports.data.newSubscribers }}</div>
                    </div>
                </div>
            </div>
            <div class="chart-container-spread">
                <canvas id="campaignSpreadChart"></canvas>
            </div>
        </div>

        <div class="d-flex">
            <div class="chart-container-channel mr-1">
                <canvas id="campaignSpreadChart2"></canvas>
            </div>

            <div class="chart-container-bar mr-2">
                <canvas id="funnelChart"></canvas>
            </div>

            <div class="chart-container-social">
                <div class="channels-list">
                    <p>Active Channels</p>
                    <!-- <p><span>View All ></span></p> -->
                </div>
                <div>
                    <div class="social-btn">
                        {% if reports.data.socialEngagements.facebook.isConnected %}
                        <div class="channel-icon-container">
                            <i class="facebook-icon fab fa-facebook-f"></i>
                        </div>
                        {% endif %}
                        {% if reports.data.socialEngagements.youtube.isConnected %}
                        <div class="channel-icon-container">
                            <i class="youtube-icon fab fa-youtube"></i>
                        </div>
                        {% endif %}
                        {% if reports.data.socialEngagements.instagram.isConnected %}
                        <div class="channel-icon-container">
                            <i class="instagram-icon fab fa-instagram"></i>
                        </div>
                        {% endif %}
                    </div>
                    <div class="social-btn">
                        {% if reports.data.socialEngagements.email.isConnected %}
                        <div class="channel-icon-container">
                            <i class="email-icon fas fa-envelope"></i>
                        </div>
                        {% endif %}
                        {% if reports.data.socialEngagements.sms.isConnected %}
                        <div class="channel-icon-container">
                            <i class="sms-icon fas fa-comment-dots"></i>
                        </div>
                        {% endif %}
                        {% if reports.data.socialEngagements.whatsApp.isConnected %}
                        <div class="channel-icon-container">
                            <i class="whatsapp-icon fab fa-whatsapp"></i>
                        </div>
                        {% endif %}

                    </div>
                </div>
            </div>
        </div>
    </section>



    <!-- Social Media Engagement Details -->
    <section class="section">
        <b><h2 class="section-title">Engagement</h2></b>
        <div class="social-grid">
            <!-- Facebook Card -->
            <div class="social-card">
                <div class="social-header">
                    <i class="fab fa-facebook-f channel-icon facebook-icon"></i>
                    <span class="social-title">Facebook</span>
                </div>
                <div class="social-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.facebook.views }}</div>
                        <div class="stat-label">Views</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.facebook.likes }}</div>
                        <div class="stat-label">Likes</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.facebook.comments }}</div>
                        <div class="stat-label">Comments</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.facebook.wow }}</div>
                        <div class="stat-label">Wow</div>
                    </div>
                </div>
            </div>

            <!-- YouTube Card -->
            <div class="social-card">
                <div class="social-header">
                    <i class="fab fa-youtube channel-icon youtube-icon"></i>
                    <span class="social-title">YouTube</span>
                </div>
                <div class="social-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.youtube.views }}</div>
                        <div class="stat-label">Views</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.youtube.likes }}</div>
                        <div class="stat-label">Likes</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.youtube.comments }}</div>
                        <div class="stat-label">Comments</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.youtube.dislikes }}</div>
                        <div class="stat-label">Dislikes</div>
                    </div>
                </div>
            </div>

            <!-- Instagram Card -->
            <div class="social-card">
                <div class="social-header">
                    <i class="fab fa-instagram channel-icon instagram-icon"></i>
                    <span class="social-title">Instagram</span>
                </div>
                <div class="social-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.instagram.views }}</div>
                        <div class="stat-label">Views</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.instagram.likes }}</div>
                        <div class="stat-label">Likes</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.instagram.comments }}</div>
                        <div class="stat-label">Comments</div>
                    </div>
                </div>
            </div>

            <!-- Email Card -->
            <div class="social-card">
                <div class="social-header">
                    <i class="fas fa-envelope channel-icon email-icon"></i>
                    <span class="social-title">Email</span>
                </div>
                <div class="social-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.email.noOfEmails }}</div>
                        <div class="stat-label">Emails Sent</div>
                    </div>
                </div>
            </div>

            <!-- SMS Card -->
            <div class="social-card">
                <div class="social-header">
                    <i class="fas fa-comment-dots channel-icon sms-icon"></i>
                    <span class="social-title">SMS</span>
                </div>
                <div class="social-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.sms.noOfSms }}</div>
                        <div class="stat-label">Messages Sent</div>
                    </div>
                </div>
            </div>

            <!-- WhatsApp Card -->
            <div class="social-card">
                <div class="social-header">
                    <i class="fab fa-whatsapp channel-icon whatsapp-icon"></i>
                    <span class="social-title">WhatsApp</span>
                </div>
                <div class="social-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ reports.data.socialEngagements.whatsApp.noOfWhatsApp }}</div>
                        <div class="stat-label">Messages Sent</div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <section class="section">
        <div class="section-header">
            <h2>Direct Messaging Effectiveness</h2>
            <p>Select the tabs below to check the performance of each channel.</p>
            <div id="chartContainer" style="height: 300px; width: 100%;"></div>
        </div>
    </section>

    <section class="section">
        <div class="mt-1">
            <h2>Posts Online</h2>
                    <div class="stats-cards-wrapper3">
                        <div class="stats-card3">
                            <div class="stats-title3">Instagram</div>
                            <div class="stats-content-wrapper3 post-adjust3">
                                <div class="stats-content3">
                                    <div class="stats-number3">34</div>
                                    <div class="stats-label3">Posts</div>
                                </div>
                                <div class="stats-content3">
                                    <div class="stats-number3">87</div>
                                    <div class="stats-label3">Reels</div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-card3">
                            <div class="stats-title3">Facebook</div>
                            <div class="stats-content-wrapper3 post-adjust3">
                                <div class="stats-content3">
                                    <div class="stats-number3">34</div>
                                    <div class="stats-label3">Posts</div>
                                </div>
                                <div class="stats-content3">
                                    <div class="stats-number3">87</div>
                                    <div class="stats-label3">Reels</div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-card3">
                            <div class="stats-title3">Youtube</div>
                            <div class="stats-content-wrapper3 post-adjust3">
                                <div class="stats-content3">
                                    <div class="stats-number3">92</div>
                                    <div class="stats-label3">Videos</div>
                                </div>
                                <div class="stats-content3">
                                    <div class="stats-number3">22</div>
                                    <div class="stats-label3">Shorts</div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-card3">
                            <div class="stats-title3">Linkedin</div>
                            <div class="stats-content-wrapper3">
                                <div class="stats-content3">
                                    <div class="stats-number3">34</div>
                                    <div class="stats-label3">Posts</div>
                                </div>
                            </div>
                        </div>
                        <div class="stats-card3">
                            <div class="stats-title3">Whats app</div>
                            <div class="stats-content-wrapper3">
                                <div class="stats-content3">
                                    <div class="stats-number3">34</div>
                                    <div class="stats-label3">Posts</div>
                                </div>
                            </div>
                        </div>
                        <div class="stats-card3">
                            <div class="stats-title3">SMS</div>
                            <div class="stats-content-wrapper3">
                                <div class="stats-content3">
                                    <div class="stats-number3">93</div>
                                    <div class="stats-label3">SMS</div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-card3">
                            <div class="stats-title3">X</div>
                            <div class="stats-content-wrapper3">
                                <div class="stats-content3">
                                    <div class="stats-number3">34</div>
                                    <div class="stats-label3">Tweets</div>
                                </div>
                            </div>
                        </div>
                    </div>

                <!-- Calendar Section -->
                <div class="row content_header">
                    <div class="col-6">
                        <h2 class="title mb-0 mt-2">Calendar
                        </h2>
                    </div>
                </div>
                <div class="content_body">
                    <div class="row">
                            <div class="calendar_events">
                                <div class="calendar_date_group">
                                    <div class="header">17th December'24</div>
                                    <div class="date_events">
                                        <div class="calendar_card success">
                                            <div class="body">
                                                <div class="left">
                                                    <h3>7:24 PM</h3>
                                                    <small class="text-muted">
                                                        <b>SUCCESS</b>
                                                    </small>
                                                </div>
                                                <span class="social-icons icon-rounded icon-zoom">
                                                    <i class="fa fa-instagram fa-2x" aria-hidden="true"></i>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="calendar_card success">
                                            <div class="body">
                                                <div class="left">
                                                    <h3>8:24 PM</h3>
                                                    <small class="text-muted">
                                                        <b>SUCCESS</b>
                                                    </small>
                                                </div>
                                                <span class="social-icons icon-rounded icon-zoom">
                                                    <i class="fa fa-facebook fa-2x" aria-hidden="true"></i>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="calendar_card failed">
                                            <div class="body">
                                                <div class="left">
                                                    <h3>7:24 PM</h3>
                                                    <small class="text-muted">
                                                        <b>FAILED</b>
                                                    </small>
                                                </div>
                                                <span class="social-icons icon-rounded icon-zoom">
                                                    <i class="fa fa-linkedin fa-2x" aria-hidden="true"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="calendar_date_group">
                                    <div class="header">18th December'24</div>
                                    <div class="date_events">
                                        <div class="calendar_card waiting">
                                            <div class="body">
                                                <div class="left">
                                                    <h3>5:24 PM</h3>
                                                    <small class="text-muted">
                                                        <b>WAITING</b>
                                                    </small>
                                                </div>
                                                <span class="social-icons icon-rounded icon-zoom">
                                                    <i class="fa fa-instagram fa-2x" aria-hidden="true"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
        </div>
    </section>

    <!-- leads score -->
    <section class="section">
        <h2>Leads Score - Social Inbox</h2>
        <div class="stats-cards-wrapper">
            <div class="stats-card1">
                <div class="stats-title">Total responses</div>
                <div class="stats-content">
                    <div class="stats-number">34</div>
                    <div class="stats-label">Posts</div>
                </div>
            </div>
            <div class="stats-card1">
                <div class="stats-title">Qualified leads</div>
                <div class="stats-content">
                    <div class="stats-number">{{ reports.data.leadScoreSocialInbox.qualifiedLeads }}</div>
                    <div class="stats-label">Posts</div>
                </div>
            </div>
            <div class="stats-card1">
                <div class="stats-title">Replied back</div>
                <div class="stats-content">
                    <div class="stats-number">{{ reports.data.leadScoreSocialInbox.repliedBack }}</div>
                    <div class="stats-label">Posts</div>
                </div>
            </div>
            <div class="stats-card1">
                <div class="stats-title">Closed</div>
                <div class="stats-content">
                    <div class="stats-number">{{ reports.data.leadScoreSocialInbox.closed }}</div>
                    <div class="stats-label">Posts</div>
                </div>
            </div>
        </div>

        <div class="charts-section mb-4">
            <div class="chart-container">
                <h2>Reach social index % by channels</h2>
                <canvas id="socialChart"></canvas>
            </div>
        </div>
    </section>

    <section class="google-reviews">
        <h2>Google Reviews</h2>
        <div class="google-section">
            <div class="google-content">
                <div class="text-center">
                    <div class="google-left">
                        <img src="https://images.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png"
                            alt="Google" class="google-logo">
                        <div class="verified-text">Verified Reviews</div>
                        <div>
                            <span class="verified-icon">✓</span>
                            <span class="stars">★★★★★</span>
                        </div>
                    </div>
                </div>
                <div class="google-right">
                    <div class="stats-card">
                        <div class="stats-title">Overall Rating</div>
                        <div class="stats-content">
                            <div class="stats-number">{{reports.data.reviews.overAll}}<span class="stars">★</span>
                            </div>
                            <div class="stats-label">Stars</div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-title">Total Reviews</div>
                        <div class="stats-content">
                            <div class="stats-number">{{reports.data.reviews.totalReviews}}</div>
                            <div class="stats-label">Reviews</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="reviews-boxes">
            <div class="review">
                <p>{{reports.data.reviews.topReviews[0].text}}</p>
                <div class="reviewer">
                    <img src="/assets/images/PewDiePie.webp" alt="Reviewer">
                    <p>{{reports.data.reviews.topReviews[1].name}}</p>
                </div>
            </div>
            <div class="review">
                <p>{{reports.data.reviews.topReviews[1].text}}</p>
                <div class="reviewer">
                    <img src="/assets/images/PewDiePie.webp" alt="Reviewer">
                    <p>{{reports.data.reviews.topReviews[1].name}}</p>
                </div>
            </div>
            <div class="review">
                <p>{{reports.data.reviews.topReviews[2].text}}</p>
                <div class="reviewer">
                    <img src="/assets/images/PewDiePie.webp" alt="Reviewer">
                    <p>{{reports.data.reviews.topReviews[1].name}}</p>
                </div>
            </div>
        </div>
    </section>

    <!-- paid analytics -->
    <section>
        <div class="container mt-5">
            <h2 class="mb-4">Paid Analytics</h2>
            <div class="dropdown-container">
                <select class="form-select">
                    <option selected>Last 4 weeks</option>
                    <option value="1">Last week</option>
                    <option value="2">Last month</option>
                    <option value="3">Last year</option>
                </select>
            </div>
            <div class="d-flex">
                <div class="metrics-container">

                    <!-- Metrics Row 1 -->
                    <div class="stats-cards-wrapper">
                        <div class="stats-card">
                            <div class="stats-title">Spend</div>
                            <div class="stats-content">
                                <div class="stats-number">111,332<span class="trend-up">↑</span></div>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-title">Reach</div>
                            <div class="stats-content">
                                <div class="stats-number">111,332<span class="trend-up">↑</span></div>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-title">Clicks</div>
                            <div class="stats-content">
                                <div class="stats-number">111,332<span class="trend-up">↑</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Metrics Row 2 -->
                    <div class="stats-cards-wrapper">
                        <div class="stats-card">
                            <div class="stats-title">Impressions</div>
                            <div class="stats-content">
                                <div class="stats-number">111,332<span class="trend-up">↑</span></div>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-title">Engagement</div>
                            <div class="stats-content">
                                <div class="stats-number">111,332<span class="trend-up">↑</span></div>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-title">Avg. CPM (PKR)</div>
                            <div class="stats-content">
                                <div class="stats-number">111,332<span class="trend-up">↑</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Metrics Row 3 -->
                    <div class="metrics-row">
                        <div class="metric-card">
                            <div class="metric-title">Share of Spend</div>
                            <div class="donut-container">
                                <canvas id="spendChart"></canvas>
                                <div class="chart-center-value">8,897,392</div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-title">Share of Impressions</div>
                            <div class="donut-container">
                                <canvas id="impressionsChart"></canvas>
                                <div class="chart-center-value">8,897,392</div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-title">Share of Reach</div>
                            <div class="donut-container">
                                <canvas id="reachChart"></canvas>
                                <div class="chart-center-value">8,897,392</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="side-card channels-card">
                    <div class="metric-title">Channels</div>
                    <ul class="channels-list">
                        <li><span class="channel-dot" style="background: #ff4444"></span>Facebook</li>
                        <li><span class="channel-dot" style="background: #ff8c00"></span>Insta</li>
                        <li><span class="channel-dot" style="background: #00bcd4"></span>LinkedIn</li>
                        <li><span class="channel-dot" style="background: #4CAF50"></span>Google Reviews</li>
                        <li><span class="channel-dot" style="background: #ffd700"></span>WhatsApp</li>
                        <li><span class="channel-dot" style="background: #ffd700"></span>YouTube</li>
                        <li><span class="channel-dot" style="background: #ffd700"></span>X</li>
                    </ul>
                </div>
            </div>
        </div>

    </section>

    {% endif %}
</div>
</div>


<script>
    

    // Campaign Spread Chart
    const social =`{{reports.data.campaignSpread.social}}`;
    const referral =`{{reports.data.campaignSpread.referral}}`;
    const paid =`{{reports.data.campaignSpread.paid}}`;
    new Chart(document.getElementById('campaignSpreadChart'), {
        type: 'doughnut',
        data: {
            labels: ['social','referral','paid'],
            datasets: [{
                data: [social, referral, paid],
                backgroundColor: [
                    'rgba(33, 150, 243, 0.8)',
                    'rgba(76, 175, 80, 0.8)',
                    'rgba(255, 152, 0, 0.8)',

                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'right',
                    labels: {
                        usePointStyle: true, 
                        pointStyle: 'circle',
                        color: '#333',
                        font: {
                            size: 14 
                        }
                    }
                },
                title: {
                    display: true,
                    text: 'Channel Contribution to Total Subscribers'
                }
            }
        }
    });

    const channel1 =`{{reports.data.channelContributionToTotalSubscribers.channel1}}`;
    const channel2 =`{{reports.data.channelContributionToTotalSubscribers.channel2}}`;
    const channel3 =`{{reports.data.channelContributionToTotalSubscribers.channel3}}`;
    const channel4 =`{{reports.data.channelContributionToTotalSubscribers.channel4}}`;
    const channel5 =`{{reports.data.channelContributionToTotalSubscribers.channel5}}`;

    new Chart(document.getElementById('campaignSpreadChart2'), {
        type: 'doughnut',
        data: {
            labels: ['channel1','channel2','channel3','channel4','channel5'],
            datasets: [{
                data: [channel1, channel2, channel3,channel4,channel5],
                backgroundColor: [
                    'rgba(33, 150, 243, 0.8)',
                    'rgba(76, 175, 80, 0.8)',
                    'rgba(255, 152, 0, 0.8)',
                    'rgba(65, 152, 0, 0.8)',
                    'rgba(255, 175, 0, 0.8)',

                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'right',
                    labels: {
                        usePointStyle: true, 
                        pointStyle: 'circle',
                        color: '#333', 
                        font: {
                            size: 14 
                        }
                    }
                },
                title: {
                    display: true,
                    text: 'Channel Contribution to Total Subscribers'
                }
            }
        }
    });

    // Channel Contribution Chart
    new Chart(document.getElementById('channelContributionChart'), {
        type: 'bar',
        data: {
            labels: ['Channel 1', 'Channel 2', 'Channel 3', 'Channel 4', 'Channel 5'],
            datasets: [{
                label: 'Contribution (%)',
                data: [25, 9, 16, 20, 30],
                backgroundColor: 'rgba(76, 175, 80, 0.8)'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Channel Contribution'
                }
            }
        }
    });

    document.addEventListener("DOMContentLoaded", () => {
        // Data for channels
        const channelLabels = ['Facebook', 'Instagram', 'LinkedIn', 'Google Reviews', 'WhatsApp', 'YouTube', 'X'];
        const channelData = [22, 25, 14, 10, 16, 8, 5];
        const channelColors = [
            'rgba(33, 150, 243, 0.8)',
            'rgba(233, 30, 99, 0.8)',
            'rgba(76, 175, 80, 0.8)',
            'rgba(255, 152, 0, 0.8)',
            'rgba(0, 150, 136, 0.8)',
            'rgba(63, 81, 181, 0.8)',
            'rgba(255, 235, 59, 0.8)'
        ];

        // Add channel names and colors to the Channels Box
        const channelsBox = document.querySelector('.channels-box');

        channelLabels.forEach((label, index) => {
            const channelCard = document.createElement('div');
            channelCard.classList.add('channel-card');

            const channelColor = document.createElement('div');
            channelColor.classList.add('channel-color');
            channelColor.style.backgroundColor = channelColors[index]; 

            const channelText = document.createElement('span');
            channelText.textContent = `${label}`; 

            channelCard.appendChild(channelColor);
            channelCard.appendChild(channelText);
            channelsBox.appendChild(channelCard);
        });

        // Chart configurations
        const chartConfigs = [
            {
                elementId: 'shareOfSpendChart',
                title: 'Share of Spend'
            },
            {
                elementId: 'shareOfImpressionsChart',
                title: 'Share of Impressions'
            },
            {
                elementId: 'shareOfReachChart',
                title: 'Share of Reach'
            }
        ];

        chartConfigs.forEach(config => {
            const ctx = document.getElementById(config.elementId).getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: channelData,
                        backgroundColor: channelColors
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: config.title
                        },
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });
        });
    });








const topchannel1 =`{{reports.data.topPerformingChannels.channel1}}`;
const topchannel2 =`{{reports.data.topPerformingChannels.channel2}}`;
const topchannel3 =`{{reports.data.topPerformingChannels.channel3}}`;
const topchannel4 =`{{reports.data.topPerformingChannels.channel4}}`;
const topchannel5 =`{{reports.data.topPerformingChannels.channel5}}`;
const funnelDataRaw= [topchannel1, topchannel2, topchannel3, topchannel4, topchannel5]
const funnelNumericData = funnelDataRaw.map(value => parseInt(value) * 1000);


    const funnelCtx = document.getElementById('funnelChart').getContext('2d');
    new Chart(funnelCtx, {
        type: 'bar',
        data: {
            labels: ['Channel 1', 'Channel 2', 'Channel 3', 'Channel 4', 'Channel 5'],
            datasets: [{
                label: 'Messages',
                data: funnelNumericData,
                backgroundColor: ['#ff6f61', '#ffcc00', '#87ceeb', '#8a2be2', '#4caf50'],
            }]
        },
        options: {
            indexAxis: 'y',
            aspectRatio: 1.8,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                x: {
                    beginAtZero: true
                }
            }
        }
    });


    const total_sent = parseInt(`{{reports.data.directMessagingEffectiveness[0].total_sent}}`, 10) || 0;
    const total_delivered = parseInt(`{{reports.data.directMessagingEffectiveness[0].total_delivered}}`, 10)||0;
const total_read = parseInt(`{{reports.data.directMessagingEffectiveness[0].total_read}}`,10)||0;
const total_replied = parseInt(`{{reports.data.directMessagingEffectiveness[0].total_replied}}`,10)||0;

window.onload = function () {

var chart = new CanvasJS.Chart("chartContainer", {
	animationEnabled: true,
    backgroundColor: "transparent", 
	data: [{
		type: "funnel",
		indexLabel: "{label} - {y}",
		toolTipContent: "<b>{label}</b>: {y} <b>({percentage}%)</b>",
		neckWidth: 20,
		neckHeight: 0,
		valueRepresents: "area",
		dataPoints: [
			{ y: total_sent, label: "sent",color: "#1998bf", },
			{ y: total_delivered, label: "delivered",color: "#4469e2"},
			{ y: total_read, label: "read" },
			{ y: total_replied, label: "replied",color: "#50d444"},
		]
	}]
});
calculatePercentage();
chart.render();

function calculatePercentage() {
	var dataPoint = chart.options.data[0].dataPoints;
	var total = dataPoint[0].y;
	for(var i = 0; i < dataPoint.length; i++) {
		if(i == 0) {
			chart.options.data[0].dataPoints[i].percentage = 100;
		} else {
			chart.options.data[0].dataPoints[i].percentage = ((dataPoint[i].y / total) * 100).toFixed(2);
		}
	}
}

}


    const chartConfig = {
        type: 'doughnut',
        data: {
            labels: ['Instagram', 'LinkedIn', 'Google Reviews', 'Facebook', 'WhatsApp'],
            datasets: [{
                data: [28, 22, 9, 25, 16],
                backgroundColor: [
                    '#ff8c00',
                    '#00bcd4', 
                    '#4CAF50',
                    '#ff4444', 
                    '#ffd700', 
                ],
                borderWidth: 0,
            }]
        },
        options: {
            cutout: '70%',
            plugins: {
                legend: {
                    display: false
                }
            },
            responsive: true,
            maintainAspectRatio: false
        }
    };

    const charts = ['spend', 'impressions', 'reach'].map(id => {
        return new Chart(
            document.getElementById(id + 'Chart').getContext('2d'),
            JSON.parse(JSON.stringify(chartConfig)) // Deep clone config
        );
    });

const fbComments=`{{reports.data.reachSocialIndexByChannel.fbComments}}`;
const instaComment=`{{reports.data.reachSocialIndexByChannel.instaComment}}`;
const linkedinComments=`{{reports.data.reachSocialIndexByChannel.linkedinComments}}`;
const googleReviews=`{{reports.data.reachSocialIndexByChannel.googleReviews}}`;
const whatsAppReplied=`{{reports.data.reachSocialIndexByChannel.whatsAppReplied}}`;
const youtubeComments=`{{reports.data.reachSocialIndexByChannel.youtubeComments}}`;
const xTweets=`{{reports.data.reachSocialIndexByChannel.xTweets}}`;

    const ctx = document.getElementById('socialChart').getContext('2d');
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: [
                'Facebook Comments',
                'Insta comments',
                'Linkedin Comments',
                'Google Reviews',
                'WhatsApp Replies',
                'Youtube Comments',
                'x Tweets'
            ],
            datasets: [{
                data: [fbComments, instaComment, linkedinComments,googleReviews,whatsAppReplied,youtubeComments,xTweets],
                backgroundColor: [
                    '#FFA94D',
                    '#FF6B6B',
                    '#FFA94D',
                    '#00C1D4',
                    '#69DB7C',
                    '#FFA94D',
                    '#FFD43B',
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'right',
                    labels: {
                        usePointStyle: true,
                        padding: 20,
                        pointStyle: 'circle',
                        font: {
                            size: 12
                        }
                    }
                }
            }
        }
    });

//     $(".download").click(function (event) {
//     event.preventDefault();

//     // Get the content of the section to preview
//     var content = $("#section-to-preview").html();

//     // Open Fancybox and load the section content as HTML
//     $.fancybox.open({
//       src: content,
//       type: "html", // Type is "html" instead of "iframe"
//       closeExisting: true,
//       backFocus: true,
//       opts: {
//         keyboard: true,
//         buttons: ["close"],
//         protect: true,
//       },
//     });
// });


document.querySelector('.download-btn').addEventListener('click', () => {
    const element = document.getElementById('reportSection'); 

    html2canvas(element, { scale: 2 }).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const { jsPDF } = window.jspdf;

        const pdf = new jsPDF('p', 'mm', 'a4');

        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();
        const canvasWidth = canvas.width;
        const canvasHeight = canvas.height;

        const scale = pageWidth / canvasWidth;
        const scaledHeight = canvasHeight * scale;

        let position = 0;

        while (position < scaledHeight) {
            const canvasPage = document.createElement('canvas');
            canvasPage.width = canvasWidth;
            canvasPage.height = pageHeight / scale;

            const ctx = canvasPage.getContext('2d');
            ctx.drawImage(
                canvas,
                0,
                position / scale,
                canvasWidth,
                canvasPage.height,
                0,
                0,
                canvasWidth,
                canvasPage.height
            );

            const pageData = canvasPage.toDataURL('image/png');
            pdf.addImage(pageData, 'PNG', 0, 0, pageWidth, pageHeight);

            position += pageHeight;

            if (position < scaledHeight) {
                pdf.addPage();
            }
        }

        pdf.save('report.pdf');
    });
});


document.querySelector('.link-in-iframe1').addEventListener('click', () => {
    const element = document.getElementById('reportSection');

    const totalWidth = element.scrollWidth;
    const totalHeight = element.scrollHeight;

    html2canvas(element, {
        scale: 2,
        width: totalWidth,
        height: totalHeight,
        x: 0,
        y: 0,
        useCORS: true
    }).then(canvas => {
        const imgData = canvas.toDataURL('image/png');

        const printWindow = window.open('', '', 'height=600,width=800');

        printWindow.document.write('<html><head><title>Print Report</title></head><body>');
        printWindow.document.write('<img src="' + imgData + '" style="width: 100%; height: auto;" />');

        printWindow.document.write('</body></html>');
        printWindow.document.close();

        setTimeout(function() {
            printWindow.print();
        }, 500);
    });
});


</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script type="text/javascript" src="{{ js_path }}/lib/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

<script>
    const REPORTS_AJAX_SOURCE = '{{ url("reports_ajax") | raw }}';
</script>